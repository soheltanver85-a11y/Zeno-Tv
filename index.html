<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zeno TV - Android TV Edition</title>

    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet"/>
    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>

    <style>
        body {
            margin: 0;
            background: #000;
            color: #fff;
            font-family: 'Segoe UI', Arial, sans-serif;
            overflow: hidden; /* স্ক্রিন স্ক্রল বন্ধ রাখতে */
        }

        #player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1;
        }

        /* চ্যানেল লিস্টের নিচের অংশ */
        .overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40%;
            background: linear-gradient(transparent, rgba(0,0,0,0.95));
            z-index: 2;
            display: flex;
            align-items: flex-end;
            padding-bottom: 40px;
        }

        .channel-row {
            display: flex;
            gap: 25px;
            padding: 0 60px;
            overflow-x: auto;
            scroll-behavior: smooth; /* রিমোট নেভিগেশনের জন্য */
            width: 100%;
        }

        .channel-row::-webkit-scrollbar {
            display: none; /* স্ক্রলবার লুকানো */
        }

        .channel-card {
            flex: 0 0 240px;
            height: 140px;
            background: #1a1a1a;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 600;
            text-align: center;
            outline: none;
            border: 5px solid transparent;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        /* রিমোট ফোকাস স্টাইল - এটি টিভির জন্য সবচেয়ে জরুরি */
        .channel-card:focus {
            border-color: #ff0000; /* লাল বর্ডার */
            transform: scale(1.18); /* কার্ড বড় হবে */
            background: #333;
            box-shadow: 0 0 25px rgba(255, 0, 0, 0.5);
            z-index: 10;
        }

        .channel-logo {
            width: 70px;
            height: 70px;
            margin-bottom: 12px;
            object-fit: contain;
            pointer-events: none;
        }
    </style>
</head>

<body>

<video id="player" class="video-js vjs-default-skin" autoplay playsinline></video>

<div class="overlay">
    <div class="channel-row" id="channelList">
        </div>
</div>

<script>
    const m3uUrl = "https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv2/refs/heads/main/Live-tv2";
    const player = videojs('player');

    async function fetchM3U() {
        try {
            const res = await fetch(m3uUrl);
            const text = await res.text();
            const lines = text.trim().split("\n");
            
            let channels = [];
            for (let i = 0; i < lines.length; i++) {
                if (lines[i].startsWith("#EXTINF")) {
                    const info = lines[i];
                    const nextUrl = lines[i + 1]?.trim();

                    if (nextUrl && !nextUrl.startsWith("#")) {
                        const name = info.split(",")[1]?.trim() || "Unknown Channel";
                        const logoMatch = info.match(/tvg-logo="([^"]+)"/);
                        const logo = logoMatch ? logoMatch[1] : "https://via.placeholder.com/150x100?text=TV";

                        channels.push({ name, url: nextUrl, logo });
                    }
                }
            }
            renderChannels(channels);
        } catch (e) {
            console.error("Error loading M3U:", e);
        }
    }

    function renderChannels(channels) {
        const list = document.getElementById("channelList");
        list.innerHTML = "";

        channels.forEach((ch) => {
            const card = document.createElement("div");
            card.className = "channel-card";
            card.tabIndex = 0; // রিমোটের ফোকাস ধরার জন্য এটি আবশ্যক

            card.innerHTML = `
                <img class="channel-logo" src="${ch.logo}">
                <span>${ch.name}</span>
            `;

            // যখন কোনো চ্যানেলে ফোকাস করা হবে (রিমোট দিয়ে)
            card.onfocus = () => {
                player.src({ type: 'application/x-mpegURL', src: ch.url });
                player.play();
                
                // চ্যানেলটি স্ক্রিনের মাঝখানে আনবে
                card.scrollIntoView({ behavior: "smooth", block: "nearest", inline: "center" });
            };

            // রিমোটের 'OK' বাটন প্রেস করলে প্লে হবে
            card.onclick = () => {
                player.play();
            };

            list.appendChild(card);
        });

        // ১ সেকেন্ড পর প্রথম চ্যানেলটি অটোমেটিক ফোকাস হবে
        setTimeout(() => {
            document.querySelector(".channel-card")?.focus();
        }, 1000);
    }

    // টিভির রিমোটের কি-বোর্ড কন্ট্রোল হ্যান্ডলিং
    document.addEventListener('keydown', function(e) {
        const active = document.activeElement;
        if (e.key === "ArrowRight") {
            active.nextElementSibling?.focus();
        } else if (e.key === "ArrowLeft") {
            active.previousElementSibling?.focus();
        }
    });

    fetchM3U();
</script>

</body>
</html>
