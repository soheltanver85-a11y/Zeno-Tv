<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zeno TV Premium Ultra</title>
<link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet"/>

<style>
:root{
--accent:#ff0000;
--bg:#050505;
--card:#1a1a1a;
--gold:#ffd700;
}

body{margin:0;background:var(--bg);color:#fff;font-family:Segoe UI;overflow:hidden}

/* PLAYER */
#player-wrapper{
height:45vh;
width:100%;
position:fixed;
top:0;
left:0;
background:#000;
z-index:200;
}
.video-js{width:100%!important;height:100%!important}

/* UI */
#ui-overlay{
margin-top:45vh;
height:55vh;
overflow-y:auto;
scroll-behavior:smooth;
}

.tabs-container{
display:flex;
gap:10px;
padding:12px 15px;
background:#050505;
position:sticky;
top:0;
z-index:150;
overflow-x:auto;
}

.tab,.apk-btn,.search-btn,.recent-pill,.fs-btn{
padding:8px 14px;
border-radius:8px;
cursor:pointer;
border:2px solid transparent;
background:#222;
color:#eee;
font-size:12px;
font-weight:bold;
outline:none;
white-space:nowrap;
transition:.2s;
}

.fs-btn{
background:linear-gradient(135deg,#00f2ff,#007bff);
box-shadow:0 0 20px rgba(0,123,255,.6);
}

.tab:focus,.apk-btn:focus,.search-btn:focus,
.recent-pill:focus,.fs-btn:focus,.card:focus{
background:var(--accent)!important;
border-color:#fff!important;
transform:scale(1.08);
outline:none;
}

/* SEARCH */
#search-overlay{
display:none;
position:absolute;
left:0;
top:0;
width:100%;
height:60px;
background:#050505;
z-index:300;
align-items:center;
padding:0 20px;
}

#search-input{
flex:1;
padding:10px;
background:#1a1a1a;
border:1px solid #444;
color:#fff;
border-radius:8px;
}

/* GRID */
.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(130px,1fr));
gap:15px;
padding:15px;
}

.card{
background:var(--card);
border-radius:12px;
cursor:pointer;
outline:none;
position:relative;
}

.fav-star{
position:absolute;
top:4px;
right:6px;
color:var(--gold);
display:none;
}
.card.is-fav .fav-star{display:block;}

.logo-box{
height:75px;
display:flex;
align-items:center;
justify-content:center;
background:#111;
margin:4px;
border-radius:8px;
}
.logo-box img{width:70%;height:70%;object-fit:contain}

.name{
padding:6px;
font-size:11px;
font-weight:bold;
text-align:center;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
}

#osd-number{
position:fixed;
top:10%;
right:5%;
background:var(--accent);
font-size:50px;
padding:10px 25px;
border-radius:15px;
display:none;
z-index:1000;
}
</style>
</head>

<body>

<div id="osd-number"></div>

<div id="player-wrapper">
<video id="tv-player" class="video-js vjs-default-skin" controls preload="auto"></video>
</div>

<div id="ui-overlay">

<div id="search-overlay">
<input type="text" id="search-input" placeholder="‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..." oninput="searchChannels(this.value)">
<button class="tab" onclick="toggleSearch(false)">‡¶¨‡¶®‡ßç‡¶ß</button>
</div>

<div class="tabs-container">
<div class="search-btn" tabindex="0" onclick="toggleSearch(true)">üîç</div>
<div class="tab" tabindex="0" onclick="filterCategory('All')">‡¶∏‡¶¨</div>
<div class="tab" tabindex="0" onclick="filterCategory('Favorite')">‚≠ê</div>
<div class="apk-btn" tabindex="0">üì• APK</div>
<div id="recent-box" style="display:flex;gap:8px;"></div>
<button class="fs-btn" tabindex="0" onclick="goFullscreen()">‚õ∂ FULL</button>
</div>

<div id="channel-grid" class="grid"></div>
</div>

<script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>

<script>
const player=videojs('tv-player');
const m3uUrl='YOUR_M3U_LINK';

let allChannels=[];
let favorites=JSON.parse(localStorage.getItem('zeno_favs'))||[];
let recents=JSON.parse(localStorage.getItem('zeno_recents'))||[];
let longPressTimer=null;
let numBuffer="",numTimeout=null;

async function init(){
const res=await fetch(m3uUrl);
const data=await res.text();
const lines=data.split('\n');
let name="",logo="",group="";
lines.forEach(line=>{
if(line.includes('#EXTINF')){
name=line.split(',').pop().trim();
logo=(line.match(/tvg-logo="([^"]+)"/)||[])[1]||"";
group=(line.match(/group-title="([^"]+)"/)||[])[1]||"";
}
else if(line.startsWith('http')){
allChannels.push({name,url:line.trim(),logo,group});
}
});
renderGrid(allChannels);
renderRecent();
}

function renderGrid(list){
const grid=document.getElementById('channel-grid');
grid.innerHTML='';
list.forEach((ch,index)=>{
const isFav=favorites.includes(ch.url);
const card=document.createElement('div');
card.className='card'+(isFav?' is-fav':'');
card.tabIndex=0;
card.innerHTML=`
<div class="fav-star">‚≠ê</div>
<div class="logo-box">
<img src="${ch.logo}" onerror="this.src='https://via.placeholder.com/100?text=TV'">
</div>
<div class="name">${index+1}. ${ch.name}</div>
`;
card.onclick=()=>playChannel(ch);
card.onmousedown=()=>startLongPress(ch);
card.onmouseup=clearLongPress;
card.ondblclick=()=>toggleFavorite(ch);
grid.appendChild(card);
});
}

function playChannel(ch){
player.src({src:ch.url,type:'application/x-mpegURL'});
player.play();
recents=[ch,...recents.filter(i=>i.url!==ch.url)].slice(0,4);
localStorage.setItem('zeno_recents',JSON.stringify(recents));
renderRecent();
}

function toggleFavorite(ch){
if(favorites.includes(ch.url))
favorites=favorites.filter(i=>i!==ch.url);
else favorites.push(ch.url);
localStorage.setItem('zeno_favs',JSON.stringify(favorites));
renderGrid(allChannels);
}

function renderRecent(){
const box=document.getElementById('recent-box');
box.innerHTML='';
recents.forEach(ch=>{
const pill=document.createElement('div');
pill.className='recent-pill';
pill.tabIndex=0;
pill.innerText=ch.name.substring(0,6);
pill.onclick=()=>playChannel(ch);
box.appendChild(pill);
});
}

function toggleSearch(show){
document.getElementById('search-overlay').style.display=show?'flex':'none';
}

function searchChannels(q){
renderGrid(allChannels.filter(c=>c.name.toLowerCase().includes(q.toLowerCase())));
}

function filterCategory(cat){
if(cat==='Favorite')
renderGrid(allChannels.filter(c=>favorites.includes(c.url)));
else
renderGrid(allChannels);
}

function goFullscreen(){
const wrapper=document.getElementById('player-wrapper');
if(!document.fullscreenElement)
wrapper.requestFullscreen();
else document.exitFullscreen();
}

function startLongPress(ch){
longPressTimer=setTimeout(()=>{
playChannel(ch);
setTimeout(()=>goFullscreen(),300);
},700);
}
function clearLongPress(){clearTimeout(longPressTimer);}

/* STABLE REMOTE NAVIGATION */
function getFocusable(){
return Array.from(document.querySelectorAll('[tabindex="0"]'));
}

window.addEventListener('keydown',e=>{
const items=getFocusable();
const active=document.activeElement;
const index=items.indexOf(active);

if(e.key>='0'&&e.key<='9'){
numBuffer+=e.key;
const osd=document.getElementById('osd-number');
osd.innerText=numBuffer;
osd.style.display='block';
clearTimeout(numTimeout);
numTimeout=setTimeout(()=>{
const idx=parseInt(numBuffer)-1;
if(allChannels[idx])playChannel(allChannels[idx]);
numBuffer="";
osd.style.display='none';
},1500);
}

if(e.key==="ArrowRight"){
if(index<items.length-1)items[index+1].focus();
e.preventDefault();
}
if(e.key==="ArrowLeft"){
if(index>0)items[index-1].focus();
e.preventDefault();
}
if(e.key==="ArrowDown"){
const first=document.querySelector('.card');
if(first)first.focus();
e.preventDefault();
}
if(e.key==="Enter"){
active.click();
}
});

init();
</script>
</body>
</html>
